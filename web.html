<html>
<title>技能树</title>
<style>
.alsp{ font-family:"微软雅黑";}
.button {
  display: inline-block;
  border-radius: 4px;
  background-color: #236B8E;
  border: none;
  color: #FFFFFF;
  text-align: center;
  font-size: 12px;
  padding: 10px;
  width: 60px;
  transition: all 0.5s;
  cursor: pointer;
  margin: 5px;
  vertical-align:middle;
}

.button span {
  cursor: pointer;
  display: inline-block;
  position: relative;
  transition: 0.5s;
}

.button span:after {
  content: '»';
  position: absolute;
  opacity: 0;
  top: 0;
  right: -20px;
  transition: 0.5s;
}

.button:hover span {
  padding-right: 10px;
}

.button:hover span:after {
  opacity: 1;
  right: 0;
}


</style>
<head><script type="text/javascript" src="http://d3js.org/d3.v5.min.js"></script></head>
<body>
	<div class="alsp">
  	<h3 style="text-align:center;color:#D2E9FF;font-size:25px>">请输入 人员信息_技能树_所在公司历程：</h3>
	</div>
	<p style="text-align:center">
	<textarea cols="60" rows="10" id="text"></textarea>
 	</p>
	<p style="text-align:center">
	<button class="button" onclick="getTextareaValue()"><span>提交</span></button>
	</p>	 
	<script>
	d3.select("body").style("background-image","url(http://m.qpic.cn/psc?/V10sZkox0PHKFv/45NBuzDIW489QBoVep5mcXOf*hQuLVjekb.EU8i6vVmNweypCzfVB5*n5sKoygwcvjMhoF69rhAZ6Syg8UoIbq.41kLpF6FojGleAHZ*s4s!/b&bo=3AWEA9wFhAMBKQ4!&rf=viewer_4)")
	function getTextareaValue()
	{
		var content = document.all.text.value;
		var edge = new Map;
		var keyword = ["导师：","级硕士生：","级本科生：","级博士生："];
		var level = new Map;
		var farther = new Map; 
		var seen = [];
		idx_list = [];
		
		// input data process
		
		arr_str = content.split("\n");
		for (var idx = 0 ; idx < arr_str.length ; idx ++)
		{
			if (arr_str[idx] == "")
			{
				idx_list.push(idx);
			}
		}

		for (var idx1 = 0 ; idx1 < arr_str.length ; ) // layer 1
		{

			var idx2 = arr_str.length;
			console.log(arr_str);
			console.log(idx2);
			/*	
			for (idx2 = idx1 ; idx2 < arr_str.length ; idx2 ++)
			{
				if (arr_str == "")
				{
					break;
				}
			}
			*/
			// get teacher
			var term1 = arr_str[idx1].split("：");
			var name = term1[1];
			edge[name] = [];
			seen.push(name);

			// layer 2
			for (idx3 = idx1 + 1 ; idx3 < idx2 ; idx3 ++)
			{
				for (var val of keyword) // (for of) is travel by values , (for in) is travel by keys 
				{
					if (arr_str[idx3].indexOf(val) != -1)
					{
						//console.log(val);
						var term2 = arr_str[idx3].split("：");
						var temp = term2[0] + name;
						//console.log(temp);
						edge[name].push(temp);
						edge[temp] = [];
						level[temp] = val;
						farther[temp] = 1;
						seen.push(temp);
						break;	
					}
					
				}
				
				// layer 3
				var term3 = term2[1].split("、");
				for (var val of term3)
				{
					//console.log(val);
					edge[temp].push(val);
					level[val] = term2[0];
					farther[val] = 1;
					seen.push(val);
				} 
			}
			
			idx1 = idx2 + 1;
			
		}
			
		console.log(edge);	
			
	}
/*
	function getTextareaValue()
	{
		var content = document.all.text.value;
		var edge = new Map;
		var keyword = ["导师：","级硕士生：","级本科生：","级博士生："];
		var level = new Map;
		var farther = new Map; 
		var seen = [];

		// input data process

		arr_str = content.split("\n");
		for (var idx1 = 0 ; idx1 < arr_str.length ; ) // layer 1
		{

			var idx2;
			for (idx2 = idx1 ; idx2 < arr_str.length ; idx2 ++)
			{
				if (arr_str == "")
				{
					break;
				}
			}
			// get teacher
			var term1 = arr_str[idx1].split("：");
			var name = term1[1];
			edge[name] = [];
			seen.push(name);

			// layer 2
			for (idx3 = idx1 + 1 ; idx3 < idx2 ; idx3 ++)
			{
				for (var val of keyword) // (for of) is travel by values , (for in) is travel by keys 
				{
					if (arr_str[idx3].indexOf(val) != -1)
					{
						//console.log(val);
						var term2 = arr_str[idx3].split("：");
						var temp = term2[0] + name;
						//console.log(temp);
						edge[name].push(temp);
						edge[temp] = [];
						level[temp] = val;
						farther[temp] = 1;
						seen.push(temp);
						break;	
					}
					
				}
				
				// layer 3
				var term3 = term2[1].split("、");
				for (var val of term3)
				{
					//console.log(val);
					edge[temp].push(val);
					level[val] = term2[0];
					farther[val] = 1;
					seen.push(val);
				} 
			}
			
			idx1 = idx2 + 1;
			
		}
			
		console.log(edge);	
			
	}
*/	

		//arr_str = ["导师：张三", "2016级博士生：天一、王二、吴五", "2015级硕士生：李四、王五、许六", "2016级硕士生：刘一、李二、李三", "2017级本科生：刘六、琪七、司//四","", "刘六：JAVA、数学建模", "", "李二：字节跳动、京东云"]	
		//console.log(arr_str);
		




	</script>
</body>
</html>